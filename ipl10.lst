     1                                  CYLS	EQU		10
     2                                  		ORG		0x7c00		; このプログラムがどこに読み込まれるのか
     3                                  
     4                                  ; 以降，512バイトがブートセクタ
     5 00000000 EB50                    		JMP		entry
     6 00000002 90                      		DB		0x90		; iplへのジャンプ
     7                                  
     8 00000003 48415249424F5445        		DB		"HARIBOTE"		; OEM名
     9                                  
    10                                  ; BPB
    11 0000000B 0002                    		DW		512		; セクタ当たりのバイト数
    12 0000000D 01                      		DB		1		; クラスタ当たりのセクタ数
    13 0000000E 0100                    		DW		1		; FATの開始セクタ番号
    14 00000010 02                      		DB		2		; FATの個数
    15 00000011 E000                    		DW		224		; ルートディレクトリのエントリー数
    16 00000013 400B                    		DW		2880		; 論理セクタの総数
    17 00000015 F0                      		DB		0xf0		; メディアディスクリプタ(f0:3.5 inch FD, f8: HD)
    18 00000016 0900                    		DW		9		; FAT当たりのセクタ数
    19 00000018 1200                    		DW		18		; トラック当たりのセクタ数
    20 0000001A 0200                    		DW		2		; 磁気ヘッド数
    21 0000001C 00000000                		DD		0		; 不可視セクタ数
    22 00000020 400B0000                		DD		2880		; 論理セクタの総数
    23                                  
    24                                  ; Extended BPB
    25 00000024 00                      		DB		0		; 物理ドライブ番号
    26 00000025 00                      		DB		0		; ダーティフラグ
    27 00000026 29                      		DB		0x29		; 拡張ブートサイン
    28 00000027 FFFFFFFF                		DD		0xffffffff		; シリアル番号
    29 0000002B 48415249424F54454F-     		DB		"HARIBOTEOS   "		; ボリューム名
    29 00000034 53202020           
    30 00000038 4641543132202020        		DB		"FAT12   "		; FATタイプ
    31 00000040 <res 00000012>          		RESB	18
    31          ******************       warning: uninitialized space declared in .text section: zeroing
    32                                  
    33                                  ; IPL本体
    34                                  
    35                                  entry:
    36 00000052 B80000                  		MOV		AX,0		 ; レジスタ初期化
    37 00000055 8ED0                    		MOV		SS,AX
    38 00000057 BC007C                  		MOV		SP,0x7c00
    39 0000005A 8ED8                    		MOV		DS,AX
    40                                  
    41 0000005C B82008                  		MOV		AX,0x0820
    42 0000005F 8EC0                    		MOV		ES,AX
    43 00000061 B500                    		MOV		CH,0
    44 00000063 B600                    		MOV		DH,0
    45 00000065 B102                    		MOV		CL,2
    46                                  
    47                                  readloop:
    48 00000067 BE0000                  		MOV		SI,0
    49                                  
    50                                  retry:
    51 0000006A B402                    		MOV		AH,0x02
    52 0000006C B001                    		MOV		AL,1
    53 0000006E BB0000                  		MOV		BX,0
    54 00000071 B200                    		MOV		DL,0x00
    55 00000073 CD13                    		INT		0x13
    56 00000075 7310                    		JNC		next
    57 00000077 83C601                  		ADD		SI,1
    58 0000007A 83FE05                  		CMP		SI,5
    59 0000007D 7340                    		JAE		error
    60 0000007F B400                    		MOV		AH,0x00
    61 00000081 B200                    		MOV		DL,0x00
    62 00000083 CD13                    		INT		0x13
    63 00000085 EBE3                    		JMP		retry
    64                                  
    65                                  next:
    66 00000087 8CC0                    		MOV		AX,ES
    67 00000089 83C020                  		ADD		AX,0x0020
    68 0000008C 8EC0                    		MOV		ES,AX
    69 0000008E 80C101                  		ADD		CL,1
    70 00000091 80F912                  		CMP		CL,18
    71 00000094 76D1                    		JBE		readloop
    72 00000096 B101                    		MOV		CL,1
    73 00000098 80C601                  		ADD		DH,1
    74 0000009B 80FE02                  		CMP		DH,2
    75 0000009E 72C7                    		JB		readloop
    76 000000A0 B600                    		MOV		DH,0
    77 000000A2 80C501                  		ADD		CH,1
    78 000000A5 80FD0A                  		CMP		CH,CYLS
    79 000000A8 72BD                    		JB		readloop
    80                                  
    81                                  fin:
    82 000000AA F4                      		HLT				; 何かあるまでCPUを停止させる
    83 000000AB EBFD                    		JMP		fin		; 無限ループ
    84                                  
    85                                  putloop:
    86 000000AD 8A04                    		MOV		AL,[SI]
    87 000000AF 83C601                  		ADD		SI,1		; SIに1を足す
    88 000000B2 3C00                    		CMP		AL,0		; 文字列の終了判定
    89 000000B4 74F4                    		JE		fin
    90 000000B6 B40E                    		MOV		AH,0x0e		; 一文字表示ファンクション
    91 000000B8 BB0F00                  		MOV		BX,15		; カラーコード
    92 000000BB CD10                    		INT		0x10		; ビデオBIOS呼び出し
    93 000000BD EBEE                    		JMP		putloop
    94                                  
    95                                  error:
    96 000000BF BE[C200]                		MOV		SI,msg
    97                                  
    98                                  msg:
    99 000000C2 0A0A                    		DB		0x0a, 0x0a		; 改行を2つ
   100 000000C4 6C6F6164206572726F-     		DB		"load error"
   100 000000CD 72                 
   101 000000CE 0A                      		DB		0x0a		; 改行
   102 000000CF 00                      		DB		0		; 文字列の終了
   103                                  
   104 000000D0 <res 0000012E>          		RESB	0x01fe-($-$$)		; 0x01feバイト目までを0x00で埋める
   104          ******************       warning: uninitialized space declared in .text section: zeroing
   105                                  
   106 000001FE 55AA                    		DB		0x55, 0xaa		; ブートシグネチャ
